<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ì‚°ì¹˜í•€ì¹˜ì‚°ì¹˜í•€ì¹˜ì‚°ì¹˜í•€ì¹˜ì‚°ì¹˜í•€ì¹˜ì‚°ì¹˜í•€ì¹˜ì‚°ì¹˜í•€ì¹˜ì‚°ì¹˜í•€ì¹˜</title>
    <style>
      body {
        margin: 0;
        overflow-x: hidden;
        display: flex;
        align-items: center;
        justify-content: center;
        background-color: #29cfb9;
        width: 100vw;
        height: 100vh;
      }

      #container {
        width: 100vw;
        height: 100vh;
      }

      svg {
        display: none;
      }
    </style>
  </head>
  <body>
    <div id="container"></div>

    <!-- path cdn -->
    <script src="https://cdn.jsdelivr.net/npm/pathseg@1.2.1/pathseg.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/poly-decomp@0.3.0/build/decomp.min.js"></script>

    <!-- matter.js cdn -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/matter-js/0.17.1/matter.js"></script>
    <script>
      // ğŸ“•ë³´í†µ matter.jsì—ì„œ íŒ¨ìŠ¤ë¥¼ ì§€ì •í•  ë•Œ ì“´ë‹¤.
      const reactangle =
        "M82 0C65.9837 0 53 12.9837 53 29C53 32.5144 53.6251 35.8828 54.7703 39C56.7703 45.4615 53 46 49 46H29C12.9837 46 0 58.9837 0 75C0 91.0163 12.9837 104 29 104H357C373.016 104 386 91.0163 386 75C386 58.9837 373.016 46 357 46H336C332 46 328.23 45.4615 330.23 39C331.375 35.8828 332 32.5144 332 29C332 12.9837 319.016 0 303 0H82Z";
      const curved =
        "m341.46,31.89c14.51,28.65,3.05,63.65-25.6,78.16-3.42,1.73-34.78,17.16-83.49,26.15-28.57,5.27-57.68,7.34-86.51,6.14-36.13-1.5-71.89-8.14-106.28-19.74C9.15,112.33-7.2,79.34,3.07,48.9,13.33,18.47,46.33,2.12,76.77,12.39c101.89,34.37,185.72-5.68,186.54-6.1,28.65-14.51,63.65-3.05,78.16,25.6Z";

      // ğŸ“•--- ì´ˆê¸° ì„¸íŒ… ---
      var Engine = Matter.Engine
        World = Matter.World,
        Bodies = Matter.Bodies;
      Body = Matter.Body;
      Composites = Matter.Composites;
      Common = Matter.Common;
      Vertices = Matter.Vertices;
      Svg = Matter.Svg;
      Composite = Matter.Composite;
      // --- ì´ˆê¸° ì„¸íŒ… ---

      // ğŸ“•Engine.create() í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ Matter.js ì—”ì§„ì„ ìƒì„±í•œë‹¤.
      const engine = Engine.create({ gravity: { y: 0.01 } });
      const container = document.getElementById("container");

      // ğŸ“•Matter.Render.create() í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ ì‹œê°ì ì¸ ë Œë”ë§ì„ ë‹´ë‹¹í•˜ëŠ” ê°ì²´ë¥¼ ìƒì„±í•œë‹¤.
      const renderer = Matter.Render.create({
        element: container,
        engine: engine,
        options: {
          width: container.offsetWidth,
          height: container.offsetHeight,
          wireframes: false,
          background: "#29cfb9",
        },
      });

      // ğŸ“•ê²½ê³„ ë²½ ìƒì„±í•˜ëŠ” ë¶€ë¶„ (ìˆœì„œëŒ€ë¡œ ì™¼ìª½, ì˜¤ë¥¸ìª½, ì•„ë˜, ìœ„ìª½ ë²½)
      const walls = [
        Bodies.rectangle(0, 0, 1, container.offsetHeight * 2, { isStatic: true }),
        Bodies.rectangle(container.offsetWidth, 0, 1, container.offsetHeight * 2, { isStatic: true }),
        Bodies.rectangle(0, container.offsetHeight, container.offsetWidth * 2, 1, { isStatic: true }),
        Bodies.rectangle(container.offsetWidth / 2, 0, container.offsetWidth * 2, 1, { isStatic: true }),
      ];

      // ğŸ“•ë¬¼ë¦¬ì  íŠ¹ì„±ì„ ì„¤ì •í•˜ëŠ” ê°ì²´ì¸ physicsë¥¼ ì •ì˜í•œë‹¤.
      const physics = {
        restitution: 0.7, // ë³µì›ë ¥
        friction: 0.7, // ë§ˆì°° ê³„ìˆ˜
      };

      // trash_images í´ë”ì— ìˆëŠ” ì´ë¯¸ì§€ ëª©ë¡ (ì´ë¯¸ì§€ëŠ” ìƒëŒ€ ê²½ë¡œë¡œ ì‘ì„±)
      const trashImages = [];
      for (let i = 1; i <= 12; i++) {
        trashImages.push(`trash_images/ì“°ë ˆê¸°${i}.png`);
      }

      // ëœë¤í•œ ì´ë¯¸ì§€ URLì„ ì„ íƒí•˜ëŠ” í•¨ìˆ˜
      const getRandomTrashImage = () => {
        const randomIndex = Math.floor(Math.random() * trashImages.length);
        return trashImages[randomIndex];
      };

      // ëœë¤í•œ ìœ„ì¹˜ë¥¼ ë°˜í™˜í•˜ëŠ” í•¨ìˆ˜
      const randomPosition = (size) => {
        const x = Math.random() * (container.offsetWidth - size);
        const y = Math.random() * (container.offsetHeight - size);
        return { x, y };
      };

      // ì  í˜•íƒœë¡œ ë³€í™˜ëœ ì‘ì€ ì› ìƒì„±
      const createDot = (sizePercentage, color) => {
        const size = Math.min(container.offsetWidth, container.offsetHeight) * (sizePercentage / 100);
        const position = randomPosition(size);
        const dot = Bodies.circle(position.x, position.y, size, {
          ...physics,
          render: {
            fillStyle: color,
            sprite: {
              texture: getRandomTrashImage(),
              xScale: 0, // í¬ê¸°ê°€ 0ì—ì„œ ì‹œì‘
              yScale: 0, // í¬ê¸°ê°€ 0ì—ì„œ ì‹œì‘
            },
          },
        });
        // ì´ˆê¸° í¬ê¸°ë¥¼ 0ìœ¼ë¡œ ì„¤ì •í•˜ê³ , ì ì°¨ì ìœ¼ë¡œ í¬ê¸°ê°€ ì»¤ì§€ë„ë¡ ì• ë‹ˆë©”ì´ì…˜ ì ìš©
        Matter.Events.on(engine, "beforeUpdate", () => scaleUp(dot));
        return dot;
      };

      // ì˜¤ë¸Œì íŠ¸ì˜ í¬ê¸°ë¥¼ ì ì°¨ì ìœ¼ë¡œ í‚¤ìš°ëŠ” í•¨ìˆ˜
      const scaleUp = (dot) => {
        const maxSize = Math.min(container.offsetWidth, container.offsetHeight) * 0.1; // ìµœì¢… í¬ê¸° (10%)
        if (dot.render.sprite.xScale < 1) {  // xScaleì´ 1ì— ë„ë‹¬í•  ë•Œê¹Œì§€ í¬ê¸°ë¥¼ ì¦ê°€ì‹œí‚¨ë‹¤.
          dot.render.sprite.xScale += 0.02; // í¬ê¸° ì¦ê°€
          dot.render.sprite.yScale += 0.02; // í¬ê¸° ì¦ê°€
          // í¬ê¸°ê°€ ìµœì¢… í¬ê¸°ì— ë„ë‹¬í•˜ë©´ ë” ì´ìƒ ì¦ê°€í•˜ì§€ ì•Šë„ë¡ ì„¤ì •
          if (dot.render.sprite.xScale > 1) {
            dot.render.sprite.xScale = 1;
            dot.render.sprite.yScale = 1;
          }
        }
      };

      // ë¬¼ë¦¬ì  ìš”ì†Œë“¤ (ì ë“¤) ìƒì„±
      const elements = [
        createDot(10, "#ffffff"),
        createDot(10, "#ffffff"),
        createDot(10, "#ffffff"),
        createDot(10, "#ffffff"),
        createDot(10, "#ffffff"),
        createDot(10, "#ffffff"),
        createDot(10, "#ffffff"),
        createDot(10, "#ffffff"),
        createDot(10, "#ffffff"),
        createDot(10, "#ffffff"),
        createDot(10, "#ffffff"),
        createDot(10, "#ffffff"),
        createDot(10, "#ffffff"),
        createDot(10, "#ffffff"),
        createDot(10, "#ffffff"),
        createDot(10, "#ffffff"),
      ];

      // ğŸ“•MouseConstraintì€ ë§ˆìš°ìŠ¤ ì…ë ¥ì„ ê¸°ë°˜ìœ¼ë¡œ ë¬¼ë¦¬ ì‹œë®¬ë ˆì´ì…˜ì— ì˜í–¥ì„ ì£¼ëŠ” ì œì•½(Constraint)ì„ ì œê³µí•œë‹¤.
      const mouseConstraint = Matter.MouseConstraint.create(engine, {
        element: container,
        constraint: {
          stiffness: 0.5,
          render: {
            visible: false,
          },
        },
      });

      // ğŸ“•World.add()ë¡œ ë¬¼ë¦¬ ì—”ì§„ ì„¸ê³„ì— ë‹¤ì–‘í•œ ë¬¼ì²´ë“¤ì„ ì¶”ê°€
      World.add(engine.world, [...walls, mouseConstraint, ...elements]);

      // ğŸ“•Engine.run()ë¡œ Matter.js ì—”ì§„ì„ ì‹¤í–‰
      Engine.run(engine);
      Matter.Render.run(renderer);

      // ğŸ“•í™”ë©´ í•˜ë‹¨ 10% í´ë¦­ ë° í„°ì¹˜ì‹œ ë¦¬ë‹¤ì´ë ‰íŠ¸
      const redirectToURL = () => {
        window.location.href = "https://jingeo-gongsajang.github.io/arte-ocean/";
      };

      // í´ë¦­ ì´ë²¤íŠ¸
      document.addEventListener("click", function (event) {
        const clickY = event.clientY;
        const screenHeight = window.innerHeight;
        if (clickY > screenHeight * 0.9) {
          redirectToURL();
        }
      });

      // í„°ì¹˜ ì´ë²¤íŠ¸
      document.addEventListener("touchstart", function (event) {
        const touchY = event.touches[0].clientY;
        const screenHeight = window.innerHeight;
        if (touchY > screenHeight * 0.9) {
          redirectToURL();
        }
      });
    </script>
  </body>
</html>
